# ============================================
# CONFIGURACIÓN DE PRODUCCIÓN PARA COOP-SERVICE-BACKEND
# ============================================
# Este archivo contiene TODAS las variables de entorno necesarias
# para el correcto funcionamiento del sistema en producción.
# 
# ⚠️  IMPORTANTE: 
# - Cambiar todos los valores por defecto
# - Usar secretos seguros y únicos
# - No versionar este archivo con datos reales
# ============================================

# ============================================
# 1. CONFIGURACIÓN DE APLICACIÓN
# ============================================

# Entorno de ejecución (OBLIGATORIO)
NODE_ENV=production

# Puerto de la aplicación (OBLIGATORIO)
PORT=3000

# Versión de la aplicación (para logs/monitoring)
npm_package_version=0.0.1

# ============================================
# 2. BASE DE DATOS (OBLIGATORIO)
# ============================================

# URL de conexión a PostgreSQL
# Formato: postgresql://usuario:password@host:puerto/database?opciones
DATABASE_URL="postgresql://usuario:password@host:5432/coop_production_db?sslmode=require"

# Configuración de logging de Prisma (opcional en producción)
PRISMA_QUERY_LOG=false

# ============================================
# 3. AUTENTICACIÓN JWT (OBLIGATORIO)
# ============================================

# Secreto para firmar tokens JWT - CAMBIAR OBLIGATORIAMENTE
JWT_SECRET="CAMBIAR-POR-SECRETO-SUPER-SEGURO-RANDOM-64-CARACTERES-MIN"

# Tiempo de vida de tokens JWT regulares
JWT_EXPIRES_IN="1h"

# ============================================
# 4. AUTENTICACIÓN SUPER ADMIN (CRÍTICO)
# ============================================

# Código de acceso adicional para SUPER_ADMIN (OBLIGATORIO en prod)
SUPER_ADMIN_ACCESS_CODE="CODIGO-ULTRA-SECRETO-PRODUCCION-2024"

# Tiempo de vida específico para tokens de SUPER_ADMIN
SUPER_ADMIN_JWT_EXPIRES_IN="4h"

# ============================================
# 5. TOKENS DE REFRESH (RECOMENDADO)
# ============================================

# Tiempo de vida de refresh tokens
REFRESH_TOKEN_EXPIRES_IN="30d"

# Secreto específico para refresh tokens (mayor seguridad)
JWT_REFRESH_SECRET="SECRETO-DIFERENTE-PARA-REFRESH-TOKENS-64-CHARS-MIN"

# ============================================
# 6. ALMACENAMIENTO DE ARCHIVOS (OBLIGATORIO)
# ============================================

# Ruta base para uploads (crear directorio con permisos correctos)
STORAGE_PATH="/app/uploads"

# Configuración para documentos KYC
KYC_UPLOAD_PATH="/app/uploads/kyc"

# Configuración para legajos de inmuebles
LEGAJOS_UPLOAD_PATH="/app/uploads/legajos"

# Configuración para onboarding
ONBOARDING_UPLOAD_PATH="/app/uploads/onboarding"

# Tamaño máximo de archivos (en bytes)
MAX_FILE_SIZE=52428800  # 50MB

# Tipos de archivo permitidos
ALLOWED_FILE_TYPES="image/jpeg,image/png,image/tiff,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document"

# ============================================
# 7. CONFIGURACIÓN DE CORS (OBLIGATORIO)
# ============================================

# Orígenes permitidos para CORS (separados por coma)
CORS_ORIGINS="https://app.cooperativas.com,https://admin.cooperativas.com"

# Métodos HTTP permitidos
CORS_METHODS="GET,HEAD,PUT,PATCH,POST,DELETE,OPTIONS"

# Headers permitidos
CORS_HEADERS="Origin,X-Requested-With,Content-Type,Accept,Authorization,X-Device-Id"

# ============================================
# 8. ENCRIPTACIÓN DE DATOS SENSIBLES (CRÍTICO)
# ============================================

# Clave para encriptar datos de proveedores de pago
PAYMENT_ENCRYPTION_KEY="CLAVE-ENCRIPTACION-PAGOS-256-BITS-SUPER-SEGURA"

# Clave para encriptar otros datos sensibles
DATA_ENCRYPTION_KEY="CLAVE-ENCRIPTACION-GENERAL-256-BITS-DIFERENTE"

# ============================================
# 9. SERVICIOS EXTERNOS (OPCIONALES)
# ============================================

# Configuración de Email (cuando se implemente)
SMTP_HOST="smtp.cooperativas.com"
SMTP_PORT=587
SMTP_USER="noreply@cooperativas.com"
SMTP_PASS="password-seguro-email"
SMTP_FROM="Sistema Cooperativas <noreply@cooperativas.com>"

# Configuración de SMS (cuando se implemente)
SMS_SERVICE_API_KEY="clave-api-servicio-sms"
SMS_SERVICE_URL="https://api.sms-provider.com"

# ============================================
# 10. MONITOREO Y LOGGING (RECOMENDADO)
# ============================================

# Nivel de logging para producción
LOG_LEVEL="warn"

# Versión de la aplicación para tracking
APP_VERSION="1.0.0"

# ============================================
# 13. CONFIGURACIÓN DE BACKUP (CRÍTICO)
# ============================================

# Configuración para backups automáticos
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Diario a las 2 AM
BACKUP_RETENTION_DAYS=30

# Configuración S3 o similar para backups
BACKUP_S3_BUCKET="cooperativas-backups"
BACKUP_S3_ACCESS_KEY="access-key-s3"
BACKUP_S3_SECRET_KEY="secret-key-s3"
BACKUP_S3_REGION="us-east-1"

# ============================================
# NOTAS IMPORTANTES PARA PRODUCCIÓN
# ============================================
#
# 1. CAMBIAR TODOS LOS SECRETOS Y CLAVES
#    - JWT_SECRET: Mínimo 64 caracteres, aleatorio
#    - SUPER_ADMIN_ACCESS_CODE: Único y complejo
#    - PAYMENT_ENCRYPTION_KEY: 256 bits, aleatorio
#
# 2. CONFIGURAR PERMISOS DE ARCHIVOS
#    - Crear directorios /app/uploads/* con permisos 755
#    - Usuario de la app debe tener write access
#
# 3. CONFIGURAR NGINX/PROXY
#    - Configurar límites de upload
#    - Headers de seguridad
#    - SSL/TLS
#
# 4. MONITOREO
#    - Configurar alertas para errores críticos
#    - Monitorear espacio en disco (uploads)
#    - Logs de acceso de SUPER_ADMIN
#
# 5. BACKUP Y RECUPERACIÓN
#    - Backup diario de base de datos
#    - Backup de archivos uploads
#    - Procedimiento de recuperación documentado
#
# 6. ROTACIÓN DE SECRETOS
#    - Cambiar JWT_SECRET periódicamente
#    - Rotar SUPER_ADMIN_ACCESS_CODE mensualmente
#    - Actualizar claves de encriptación según política
#
# ============================================